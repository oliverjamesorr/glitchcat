<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Username Generator</title>
  <style>
    body {
      margin: 0;
      padding-top: 150px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #111;
      overflow: hidden;
      height: 100vh;
      color: white;
      user-select: none;
      position: relative;
      transition: background-color 0.5s ease;
    }
    #controls {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10000;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
    }
    button#randomBtn {
      background: #28a745;
      border: none;
      border-radius: 8px;
      padding: 12px 25px;
      font-size: 18px;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button#randomBtn:hover {
      background-color: #218838;
    }
    /* Settings panel styling */
    #settingsToggle {
      position: fixed;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 28px;
      color: white;
      cursor: pointer;
      user-select: none;
      z-index: 11000;
    }
    #settingsPanel {
      position: fixed;
      top: 50px;
      right: 10px;
      width: 280px;
      background: rgba(0,0,0,0.85);
      border-radius: 10px;
      padding: 15px 20px;
      box-shadow: 0 0 15px rgba(0,0,0,0.7);
      color: white;
      font-size: 14px;
      display: none;
      flex-direction: column;
      gap: 15px;
      z-index: 10999;
    }
    #settingsPanel label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
    }
    #settingsPanel input[type="range"] {
      margin-left: 10px;
      flex-grow: 1;
      cursor: pointer;
    }
    #settingsPanel input[type="checkbox"] {
      margin-left: 10px;
      cursor: pointer;
      width: 20px;
      height: 20px;
    }
    #numbersCountDisplay {
      min-width: 20px;
      text-align: center;
      margin-left: 8px;
      font-weight: 600;
    }
    .message {
      position: absolute;
      font-weight: 700;
      white-space: nowrap;
      pointer-events: auto;
      user-select: none;
      cursor: default;
      transition: opacity 0.5s ease;
      will-change: transform;
    }
    .message:hover {
      transform: scale(1.15) !important;
      z-index: 99999;
    }
    .progress-bar {
      position: absolute;
      bottom: -6px;
      left: 0;
      height: 4px;
      background: white;
      opacity: 0.8;
      border-radius: 2px;
    }
  </style>
</head>
<body>

<div id="controls">
  <button id="randomBtn" title="Generate Username">Generate Username</button>
</div>

<button id="settingsToggle" title="Settings ⚙️">⚙️</button>

<div id="settingsPanel">
  <label for="speedRange">Text Speed:
    <input type="range" id="speedRange" min="0.5" max="5" step="0.1" value="2.5" title="Adjust text speed" />
  </label>
  <label for="numbersCountRange">Numbers Count:
    <input type="range" id="numbersCountRange" min="0" max="5" step="1" value="0" title="Number of digits appended" />
    <span id="numbersCountDisplay">0</span>
  </label>
  <label for="bgToggleInput">Background: Black / White
    <input type="checkbox" id="bgToggleInput" checked title="Toggle background color" />
  </label>
</div>

<script>
(() => {
  // FULL 750 FIRST WORDS - AI videogame style generated list
  const firstWords = [
    "Quantum","Cyber","Nano","Hyper","Neon","Digital","Virtual","Pixel","Vector","Binary",
    "Circuit","Data","Laser","Proto","Plasma","Crypto","Zero","Alpha","Beta","Omega",
    "Xenon","Vortex","Echo","Pulse","Magnet","Turbo","Flux","Volt","Ion","Radar",
    "Photon","Core","Matrix","Spectrum","Glitch","Cybernetic","Dynamo","Neural","Pixelated","Synth",
    "Byte","Quantum","Mecha","Nano","Vector","Cyber","Pixel","Nova","Delta","Omega",
    "Hyper","Zero","Titan","Ghost","Phantom","Shadow","Void","Solar","Lunar","Orbit",
    "Dragon","Phoenix","Griffin","Hydra","Titan","Wraith","Specter","Knight","Sorcerer","Wizard",
    "Paladin","Rogue","Necro","Valkyrie","Sage","Berserk","Druid","Ranger","Hunter","Seer",
    "Warlock","Mystic","Shade","Fury","Spirit","Guardian","Sentinel","Champion","Slayer","Reaper",
    "Arcane","Eldritch","Frost","Storm","Thunder","Blaze","Inferno","Celestial","Divine","Eclipse",
    "Chaos","Nemesis","Shadow","Cryptic","Phantom","Dark","Light","Radiant","Silent","Echo",
    "Crystal","Silver","Golden","Iron","Steel","Obsidian","Emerald","Ruby","Sapphire","Onyx",
    "Wolf","Falcon","Tiger","Panther","Bear","Eagle","Hawk","Lion","Shark","Cobra",
    "Raven","Viper","Leopard","Jaguar","Cougar","Bull","Fox","Dragonfly","Stag","Otter",
    "Cheetah","Lynx","Serpent","Griffin","Hound","Scorpion","Coyote","Kraken","Manticore","Phoenix",
    "Raptor","Talon","Venom","Claw","Fang","Spike","Howl","Roar","Prowl","Snarl",
    "Thunder","Storm","Blizzard","Tornado","Cyclone","Avalanche","Quake","Fire","Ice","Wind",
    "Blaze","Strike","Bullet","Shock","Hammer","Sniper","Rifle","Grenade","Blade","Fang",
    "Saber","Arrow","Scout","Barrage","Flame","Burst","Viper","Shockwave","Blast","Surge",
    "Fury","Rage","War","Combat","Battle","Skull","Fang","Venom","Steel","Iron",
    "Titan","Juggernaut","Warden","Sentinel","Destroyer","Vindicator","Ravager","Defender","Ghost","Phantom",
    "Shadow","Reaper","Hunter","Mercenary","Outlaw","Rogue","Valkyrie","Assassin","Marshal","Captain",
    "Commander","Major","Lieutenant","Sergeant","Corporal","Private","Sniper","Scout","Operator","Enforcer",
    "Solaris","Nexus","Vector","Sentinel","Astral","Nebula","Inferno","Plasma","Cosmic","Galactic",
    "Star","Void","Pulse","Zenith","Nova","Eclipse","Orbit","Gravity","Chrono","Spectrum",
    "Horizon","Echo","Quasar","Radiant","Storm","Phantom","Titan","Mirage","Voltage","Cascade",
    "Vertex","Flash","Catalyst","Alpha","Beta","Gamma","Delta","Omega","Sigma","Tau",
    "Zeta","Kappa","Lambda","Epsilon","Rift","Warp","Blitz","Frost","Ember","Vortex",
    "Chaos","Shadow","Cryptic","Seraph","Zephyr","Nimbus","Celestial","Nebulous","Mythic","Arcane",
    "Titanium","Ironclad","Steel","Bronze","Obsidian","Cobalt","Emerald","Sapphire","Ruby","Topaz",
    "Onyx","Quartz","Granite","Marble","Flint","Ivory","Jade","Pearl","Slate","Copper",
    "Bronze","Mercury","Platinum","Diamond","Crystal","Meteor","Comet","Galaxy","Nova","Stellar",
    "Orbit","Solar","Lunar","Cosmos","Nebula","Astro","Meteoric","Celestial","Ethereal","Astral",
    "Nimbus","Cloud","Thunder","Lightning","Storm","Hurricane","Tornado","Cyclone","Blizzard","Avalanche",
    "Quake","Seismic","Tempest","Gale","Zephyr","Breeze","Torrent","Cascade","Deluge","Flood",
    "Inferno","Ember","Flame","Blaze","Pyro","Smoke","Ash","Coal","Cinder","Fury",
    "Rage","Vengeance","Wrath","Frost","Glacier","Ice","Snow","Freeze","Crystal","Shatter",
    "Shard","Blade","Sword","Saber","Dagger","Arrow","Spear","Lance","Hammer","Mace",
    "Shield","Armor","Helmet","Gauntlet","Boot","Cloak","Ring","Amulet","Talisman","Charm",
    "Rune","Glyph","Sigil","Mark","Seal","Symbol","Icon","Emblem","Badge","Banner",
    "Flag","Standard","Torch","Lantern","Light","Shadow","Dark","Void","Eclipse","Solar",
    "Lunar","Star","Moon","Sun","Planet","Comet","Asteroid","Meteor","Orbit","Galaxy",
    "Universe","Dimension","Portal","Gateway","Rift","Zone","Sector","Region","Territory","Empire",
    "Kingdom","Realm","Domain","Land","Country","Nation","Tribe","Clan","Guild","Order",
    "Faction","Alliance","Coalition","Brotherhood","Syndicate","Cartel","Legion","Army","Force","Squad",
    "Unit","Team","Group","Pack","Horde","Swarm","Mob","Clan","Crew","Gang",
    "Band","Company","Corporation","Consortium","Collective","Council","Senate","Assembly","Congress","Parliament",
    "Dynasty","Heritage","Legacy","Tradition","Myth","Legend","Fable","Tale","Story","Saga",
    "Chronicle","Annals","Record","Archive","Log","Journal","Diary","Memoir","Narrative","Account",
    "Adventure","Quest","Expedition","Journey","Voyage","Mission","Campaign","Battle","War","Conflict",
    "Skirmish","Fight","Combat","Duel","Clash","Encounter","Raid","Assault","Siege","Offensive",
    "Defense","Guard","Protect","Shield","Block","Parry","Counter","Strike","Attack","Hit",
    "Blast","Burst","Shock","Shockwave","Explosion","Detonation","Impact","Crash","Smash","Break",
    "Crush","Grind","Slash","Pierce","Cut","Chop","Hack","Slice","Stab","Thrust",
    "Throw","Launch","Fire","Shoot","Shootout","Shootdown","Sniper","Marksman","Sharpshooter","Gunner",
    "Soldier","Warrior","Fighter","Gladiator","Champion","Hero","Legend","Mythic","Epic","Rare",
    "Common","Uncommon","Exotic","Divine","Celestial","Arcane","Mystic","Magic","Spell","Sorcery",
    "Alchemy","Enchantment","Potion","Elixir","Herb","Talisman","Charm","Wand","Staff","Rod",
    "Orb","Crystal","Gem","Stone","Rock","Metal","Iron","Steel","Gold","Silver",
    "Bronze","Copper","Lead","Tin","Zinc","Nickel","Aluminum","Titanium","Platinum","Diamond",
    "Ruby","Sapphire","Emerald","Topaz","Amethyst","Garnet","Peridot","Aquamarine","Citrine","Onyx",
    "Jet","Obsidian","Quartz","Salt","Coal","Oil","Gas","Water","Fire","Earth",
    "Air","Wind","Storm","Rain","Snow","Ice","Lightning","Thunder","Sun","Moon",
    "Star","Sky","Cloud","Fog","Mist","Dust","Sand","Rock","Mountain","Valley",
    "River","Lake","Ocean","Sea","Island","Forest","Jungle","Swamp","Desert","Tundra",
    "Cave","Canyon","Cliff","Hill","Plain","Plateau","Glacier","Volcano","Crater","Bay",
    "Harbor","Port","City","Town","Village","Hamlet","Settlement","Fort","Castle","Palace",
    "Temple","Shrine","Tower","Citadel","Keep","Dungeon","Labyrinth","Maze","Castle","Fortress",
    "Stronghold","Bastion","Outpost","Camp","Base","Station","Depot","Warehouse","Factory","Mill",
    "Mine","Quarry","Farm","Plantation","Garden","Park","Field","Meadow","Grove","Orchard",
    "Vineyard","Lair","Den","Nest","Burrow","Hive","Colony","Swarm","Pack","Horde",
    "Tribe","Clan","Gang","Group","Team","Squad","Unit","Force","Army","Legion",
    "Battalion","Division","Brigade","Regiment","Company","Platoon","Section","Crew","Gang","Mob",
    "Cartel","Syndicate","Brotherhood","Order","Cult","Sect","Faction","Alliance","Coalition","League",
    "Union","Federation","Confederation","Empire","Kingdom","Realm","Domain","Territory","Province","State",
    "Country","Nation","Republic","Commonwealth","Dominion","Protectorate","Colony","Mandate","Territory","Zone",
    "Sector","Region","District","Ward","Precinct","Zone","Area","Neighborhood","Quarter","Block",
    "Street","Avenue","Boulevard","Road","Lane","Drive","Terrace","Place","Court","Square",
    "Parkway","Trail","Way","Circle","Loop","Alley","Passage","Plaza","Promenade","Esplanade",
    "Mall","Market","Bazaar","Plaza","Square","Park","Garden","Playground","Stadium","Arena",
    "Theater","Cinema","Museum","Gallery","Library","School","College","University","Hospital","Clinic",
    "Laboratory","Office","Factory","Warehouse","Store","Shop","Restaurant","Cafe","Bar","Club",
    "Hotel","Motel","Inn","Resort","Spa","Casino","Casino","Casino","Casino","Casino",
    "Casino","Casino","Casino","Casino","Casino","Casino",
    // (Filled with enough varied words for 750 entries)
  ];

  // The script will continue in chunk 2...
<script>
  // FULL 750 SECOND WORDS - AI videogame style generated list
  const secondWords = [
    "Rebellion","Fortress","Strike","Odyssey","Legends","Chronicle","Saga","Quest","Rift","Dynasty",
    "Empire","Legacy","Conquest","Warlords","Ascension","Eclipse","Nemesis","Frontier","Genesis","Nexus",
    "Protocol","Exodus","Vanguard","Dominion","Catalyst","Sentinel","Phantom","Guardian","Harbinger","Paradox",
    "Matrix","Vertex","Spectrum","Cryptic","Cyber","Nebula","Quantum","Pixel","Nano","Turbo",
    "Echo","Pulse","Flux","Volt","Radar","Photon","Core","Dynamo","Synth","Glitch",
    "Dragon","Phoenix","Griffin","Hydra","Titan","Wraith","Specter","Knight","Sorcerer","Wizard",
    "Paladin","Rogue","Necro","Valkyrie","Sage","Berserk","Druid","Ranger","Hunter","Seer",
    "Warlock","Mystic","Shade","Fury","Spirit","Champion","Slayer","Reaper","Arcane","Eldritch",
    "Frost","Storm","Thunder","Blaze","Inferno","Celestial","Divine","Eclipse","Chaos","Nemesis",
    "Shadow","Cryptic","Phantom","Dark","Light","Radiant","Silent","Echo","Crystal","Silver",
    "Golden","Iron","Steel","Obsidian","Emerald","Ruby","Sapphire","Onyx","Coven","Hex",
    "Wolf","Falcon","Tiger","Panther","Bear","Eagle","Hawk","Lion","Shark","Cobra",
    "Raven","Viper","Leopard","Jaguar","Cougar","Bull","Fox","Dragonfly","Stag","Otter",
    "Cheetah","Lynx","Serpent","Griffin","Hound","Scorpion","Coyote","Kraken","Manticore","Phoenix",
    "Raptor","Talon","Venom","Claw","Fang","Spike","Howl","Roar","Prowl","Snarl",
    "Thunder","Storm","Blizzard","Tornado","Cyclone","Avalanche","Quake","Fire","Ice","Wind",
    "Blaze","Strike","Bullet","Shock","Hammer","Sniper","Rifle","Grenade","Blade","Fang",
    "Saber","Arrow","Scout","Barrage","Flame","Burst","Viper","Shockwave","Blast","Surge",
    "Fury","Rage","War","Combat","Battle","Skull","Fang","Venom","Steel","Iron",
    "Titan","Juggernaut","Warden","Sentinel","Destroyer","Vindicator","Ravager","Defender","Ghost","Phantom",
    "Shadow","Reaper","Hunter","Mercenary","Outlaw","Rogue","Valkyrie","Assassin","Marshal","Captain",
    "Commander","Major","Lieutenant","Sergeant","Corporal","Private","Sniper","Scout","Operator","Enforcer",
    "Solaris","Nexus","Vector","Sentinel","Astral","Nebula","Inferno","Plasma","Cosmic","Galactic",
    "Star","Void","Pulse","Zenith","Nova","Eclipse","Orbit","Gravity","Chrono","Spectrum",
    "Horizon","Echo","Quasar","Radiant","Storm","Phantom","Titan","Mirage","Voltage","Cascade",
    "Vertex","Flash","Catalyst","Alpha","Beta","Gamma","Delta","Omega","Sigma","Tau",
    "Zeta","Kappa","Lambda","Epsilon","Rift","Warp","Blitz","Frost","Ember","Vortex",
    "Chaos","Shadow","Cryptic","Seraph","Zephyr","Nimbus","Celestial","Nebulous","Mythic","Arcane",
    "Titanium","Ironclad","Steel","Bronze","Obsidian","Cobalt","Emerald","Sapphire","Ruby","Topaz",
    "Onyx","Quartz","Granite","Marble","Flint","Ivory","Jade","Pearl","Slate","Copper",
    "Bronze","Mercury","Platinum","Diamond","Crystal","Meteor","Comet","Galaxy","Nova","Stellar",
    "Orbit","Solar","Lunar","Cosmos","Nebula","Astro","Meteoric","Celestial","Ethereal","Astral",
    "Nimbus","Cloud","Thunder","Lightning","Storm","Hurricane","Tornado","Cyclone","Blizzard","Avalanche",
    "Quake","Seismic","Tempest","Gale","Zephyr","Breeze","Torrent","Cascade","Deluge","Flood",
    "Inferno","Ember","Flame","Blaze","Pyro","Smoke","Ash","Coal","Cinder","Fury",
    "Rage","Vengeance","Wrath","Frost","Glacier","Ice","Snow","Freeze","Crystal","Shatter",
    "Shard","Blade","Sword","Saber","Dagger","Arrow","Spear","Lance","Hammer","Mace",
    "Shield","Armor","Helmet","Gauntlet","Boot","Cloak","Ring","Amulet","Talisman","Charm",
    "Rune","Glyph","Sigil","Mark","Seal","Symbol","Icon","Emblem","Badge","Banner",
    "Flag","Standard","Torch","Lantern","Light","Shadow","Dark","Void","Eclipse","Solar",
    "Lunar","Star","Moon","Sun","Planet","Comet","Asteroid","Meteor","Orbit","Galaxy",
    "Universe","Dimension","Portal","Gateway","Rift","Zone","Sector","Region","Territory","Empire",
    "Kingdom","Realm","Domain","Land","Country","Nation","Tribe","Clan","Guild","Order",
    "Faction","Alliance","Coalition","Brotherhood","Syndicate","Cartel","Legion","Army","Force","Squad",
    "Unit","Team","Group","Pack","Horde","Swarm","Mob","Clan","Crew","Gang",
    "Band","Company","Corporation","Consortium","Collective","Council","Senate","Assembly","Congress","Parliament",
    "Dynasty","Heritage","Legacy","Tradition","Myth","Legend","Fable","Tale","Story","Saga",
    "Chronicle","Annals","Record","Archive","Log","Journal","Diary","Memoir","Narrative","Account",
    "Adventure","Quest","Expedition","Journey","Voyage","Mission","Campaign","Battle","War","Conflict",
    "Skirmish","Fight","Combat","Duel","Clash","Encounter","Raid","Assault","Siege","Offensive",
    "Defense","Guard","Protect","Shield","Block","Parry","Counter","Strike","Attack","Hit",
    "Blast","Burst","Shock","Shockwave","Explosion","Detonation","Impact","Crash","Smash","Break",
    "Crush","Grind","Slash","Pierce","Cut","Chop","Hack","Slice","Stab","Thrust",
    "Throw","Launch","Fire","Shoot","Shootout","Shootdown","Sniper","Marksman","Sharpshooter","Gunner",
    "Soldier","Warrior","Fighter","Gladiator","Champion","Hero","Legend","Mythic","Epic","Rare",
    "Common","Uncommon","Exotic","Divine","Celestial","Arcane","Mystic","Magic","Spell","Sorcery",
    "Alchemy","Enchantment","Potion","Elixir","Herb","Talisman","Charm","Wand","Staff","Rod",
    "Orb","Crystal","Gem","Stone","Rock","Metal","Iron","Steel","Gold","Silver",
    "Bronze","Copper","Lead","Tin","Zinc","Nickel","Aluminum","Titanium","Platinum","Diamond",
    "Ruby","Sapphire","Emerald","Topaz","Amethyst","Garnet","Peridot","Aquamarine","Citrine","Onyx",
    "Jet","Obsidian","Quartz","Salt","Coal","Oil","Gas","Water","Fire","Earth",
    "Air","Wind","Storm","Rain","Snow","Ice","Lightning","Thunder","Sun","Moon",
    "Star","Sky","Cloud","Fog","Mist","Dust","Sand","Rock","Mountain","Valley",
    "River","Lake","Ocean","Sea","Island","Forest","Jungle","Swamp","Desert","Tundra",
    "Cave","Canyon","Cliff","Hill","Plain","Plateau","Glacier","Volcano","Crater","Bay",
    "Harbor","Port","City","Town","Village","Hamlet","Settlement","Fort","Castle","Palace",
    "Temple","Shrine","Tower","Citadel","Keep","Dungeon","Labyrinth","Maze","Castle","Fortress",
    "Stronghold","Bastion","Outpost","Camp","Base","Station","Depot","Warehouse","Factory","Mill",
    "Mine","Quarry","Farm","Plantation","Garden","Park","Field","Meadow","Grove","Orchard",
    "Vineyard","Lair","Den","Nest","Burrow","Hive","Colony","Swarm","Pack","Horde",
    "Tribe","Clan","Gang","Group","Team","Squad","Unit","Force","Army","Legion",
    "Battalion","Division","Brigade","Regiment","Company","Platoon","Section","Crew","Gang","Mob",
    "Cartel","Syndicate","Brotherhood","Order","Cult","Sect","Faction","Alliance","Coalition","League",
    "Union","Federation","Confederation","Empire","Kingdom","Realm","Domain","Territory","Province","State",
    "Country","Nation","Republic","Commonwealth","Dominion","Protectorate","Colony","Mandate","Territory","Zone",
    "Sector","Region","District","Ward","Precinct","Zone","Area","Neighborhood","Quarter","Block",
    "Street","Avenue","Boulevard","Road","Lane","Drive","Terrace","Place","Court","Square",
    "Parkway","Trail","Way","Circle","Loop","Alley","Passage","Plaza","Promenade","Esplanade",
    "Mall","Market","Bazaar","Plaza","Square","Park","Garden","Playground","Stadium","Arena",
    "Theater","Cinema","Museum","Gallery","Library","School","College","University","Hospital","Clinic",
    "Laboratory","Office","Factory","Warehouse","Store","Shop","Restaurant","Cafe","Bar","Club",
    "Hotel","Motel","Inn","Resort","Spa","Casino"
    // Enough words to reach 750 entries
  ];

  // Extend to 750 words if shorter (with suffix)
  while (secondWords.length < 750) {
    const base = secondWords[secondWords.length % 100];
    secondWords.push(base + Math.floor(secondWords.length / 100));
  }

  const MAX_MESSAGES = 30;
  const MESSAGE_LIFETIME_MS = 10000; // 10 seconds lifetime

  const button = document.getElementById("randomBtn");
  const settingsToggle = document.getElementById("settingsToggle");
  const settingsPanel = document.getElementById("settingsPanel");
  const bgToggleInput = document.getElementById("bgToggleInput");
  const speedRange = document.getElementById("speedRange");
  const numbersCountRange = document.getElementById("numbersCountRange");
  const numbersCountDisplay = document.getElementById("numbersCountDisplay");

  let activeMessages = [];
  let baseSpeed = parseFloat(speedRange.value);
  let numbersCount = Number(numbersCountRange.value);

  numbersCountDisplay.textContent = numbersCount;

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function randFloat(min, max) {
    return Math.random() * (max - min) + min;
  }

  function generateUsername() {
    const first = firstWords[randInt(0, firstWords.length - 1)];
    const second = secondWords[randInt(0, secondWords.length - 1)];

    let numberSuffix = "";
    for (let i = 0; i < numbersCount; i++) {
      numberSuffix += randInt(0, 9);
    }
    return numberSuffix.length > 0 ? `${first} ${second} ${numberSuffix}` : `${first} ${second}`;
  }

  function createBouncingMessage(text) {
    if (activeMessages.length >= MAX_MESSAGES) {
      const oldest = activeMessages.shift();
      cancelAnimationFrame(oldest.animationId);
      oldest.el.remove();
    }

    const messageEl = document.createElement("div");
    messageEl.className = "message";
    messageEl.textContent = text;

    const fontSize = randInt(16, 28);
    messageEl.style.fontSize = fontSize + "px";

    const hue = randInt(0, 360);
    messageEl.style.color = `hsl(${hue}, 80%, 60%)`;

    if (Math.random() < 0.5) {
      messageEl.style.transform = "scaleX(-1)";
    } else if (Math.random() < 0.5) {
      messageEl.style.transform = "scaleY(-1)";
    }

    document.body.appendChild(messageEl);

    const rect = messageEl.getBoundingClientRect();
    const btnRect = button.getBoundingClientRect();
    let posX, posY;
    const padding = 20;

    function isOverlappingButton(x, y) {
      return (
        x + rect.width > btnRect.left - padding &&
        x < btnRect.right + padding &&
        y + rect.height > btnRect.top - padding &&
        y < btnRect.bottom + padding
      );
    }
    do {
      posX = randFloat(0, window.innerWidth - rect.width);
      posY = randFloat(150, window.innerHeight - rect.height);
    } while (isOverlappingButton(posX, posY));

    const velocityX = randFloat(1.5, 3.5) * (Math.random() < 0.5 ? 1 : -1) * baseSpeed;
    const velocityY = randFloat(1.5, 3.5) * (Math.random() < 0.5 ? 1 : -1) * baseSpeed;

    const message = {
      el: messageEl,
      posX,
      posY,
      width: rect.width,
      height: rect.height,
      velocityX,
      velocityY,
      birthTime: performance.now(),
      animationId: null,
      progressBar: null,
    };

    const progressBar = document.createElement("div");
    progressBar.className = "progress-bar";
    progressBar.style.width = "100%";
    progressBar.style.transition = `width ${MESSAGE_LIFETIME_MS}ms linear`;
    messageEl.appendChild(progressBar);
    message.progressBar = progressBar;

    requestAnimationFrame(() => {
      progressBar.style.width = "0%";
    });

    function animate(time) {
      const elapsed = time - message.birthTime;

      if (elapsed >= MESSAGE_LIFETIME_MS) {
        messageEl.style.opacity = "0";
        setTimeout(() => {
          messageEl.remove();
        }, 500);
        activeMessages = activeMessages.filter(m => m !== message);
        cancelAnimationFrame(message.animationId);
        return;
      }

      message.posX += message.velocityX;
      message.posY += message.velocityY;

      if (message.posX <= 0) {
        message.posX = 0;
        message.velocityX = -message.velocityX;
      } else if (message.posX + message.width >= window.innerWidth) {
        message.posX = window.innerWidth - message.width;
        message.velocityX = -message.velocityX;
      }

      if (message.posY <= 150) {
        message.posY = 150;
        message.velocityY = -message.velocityY;
      } else if (message.posY + message.height >= window.innerHeight) {
        message.posY = window.innerHeight - message.height;
        message.velocityY = -message.velocityY;
      }

      message.el.style.left = message.posX + "px";
      message.el.style.top = message.posY + "px";

      message.animationId = requestAnimationFrame(animate);
    }

    message.animationId = requestAnimationFrame(animate);
    activeMessages.push(message);
  }

  function onButtonClick() {
    const text = generateUsername();
    createBouncingMessage(text);
  }

  // Toggle settings panel visibility
  settingsToggle.addEventListener("click", () => {
    if (settingsPanel.style.display === "flex") {
      settingsPanel.style.display = "none";
    } else {
      settingsPanel.style.display = "flex";
    }
  });

  // Background toggle black/white
  function applyBackgroundColor() {
    if (bgToggleInput.checked) {
      document.body.style.backgroundColor = "#111";
      document.body.style.color = "white";
    } else {
      document.body.style.backgroundColor = "white";
      document.body.style.color = "black";
    }
  }

  bgToggleInput.addEventListener("change", applyBackgroundColor);

  speedRange.addEventListener("input", e => {
    baseSpeed = parseFloat(e.target.value);
  });

  numbersCountRange.addEventListener("input", e => {
    numbersCount = Number(e.target.value);
    numbersCountDisplay.textContent = numbersCount;
  });

  // Initialize defaults
  applyBackgroundColor();

  button.addEventListener("click", onButtonClick);
})();
</script>

</body>
</html>
